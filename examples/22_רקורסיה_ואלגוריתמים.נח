# ╔══════════════════════════════════════════════════════════════╗
# ║  דוגמה 22: רקורסיה ואלגוריתמים                               ║
# ║  Example 22: Recursion and Algorithms                        ║
# ╚══════════════════════════════════════════════════════════════╝

הדפס("╔══════════════════════════════════════════╗")
הדפס("║  🔄 רקורסיה ואלגוריתמים בנחשון          ║")
הדפס("╚══════════════════════════════════════════╝")

# ===== עצרת (Factorial) =====
הדפס("\n📊 עצרת (Factorial):")
הדפס("═" * 40)

הגדר עצרת(נ):
    """חישוב עצרת באופן רקורסיבי"""
    אם נ <= 1:
        החזר 1
    החזר נ * עצרת(נ - 1)

הגדר עצרת_איטרטיבי(נ):
    """חישוב עצרת באופן איטרטיבי"""
    תוצאה = 1
    עבור א בתוך טווח(2, נ + 1):
        תוצאה = תוצאה * א
    החזר תוצאה

עבור מספר בתוך [0, 1, 5, 10]:
    הדפס(מחרוזת(מספר) + "! = " + מחרוזת(עצרת(מספר)))

# ===== פיבונאצ'י =====
הדפס("\n🐚 סדרת פיבונאצ'י:")
הדפס("═" * 40)

הגדר פיבונאצי(נ):
    """פיבונאצ'י רקורסיבי (לא יעיל)"""
    אם נ <= 1:
        החזר נ
    החזר פיבונאצי(נ - 1) + פיבונאצי(נ - 2)

הגדר פיבונאצי_יעיל(נ):
    """פיבונאצ'י עם זיכרון (Memoization)"""
    אם נ <= 1:
        החזר נ
    
    קודם = 0
    נוכחי = 1
    עבור _ בתוך טווח(2, נ + 1):
        חדש = קודם + נוכחי
        קודם = נוכחי
        נוכחי = חדש
    החזר נוכחי

הדפס("10 המספרים הראשונים בסדרה:")
סדרה = []
עבור א בתוך טווח(10):
    סדרה = סדרה + [פיבונאצי_יעיל(א)]
הדפס(מחרוזת(סדרה))

# ===== מגדלי האנוי =====
הדפס("\n🗼 מגדלי האנוי:")
הדפס("═" * 40)

הגדר מגדלי_האנוי(נ, מקור, יעד, עזר, צעדים):
    """פתרון מגדלי האנוי"""
    אם נ == 1:
        צעדים = צעדים + ["העבר דיסק 1 מ-" + מקור + " ל-" + יעד]
        החזר צעדים
    
    צעדים = מגדלי_האנוי(נ - 1, מקור, עזר, יעד, צעדים)
    צעדים = צעדים + ["העבר דיסק " + מחרוזת(נ) + " מ-" + מקור + " ל-" + יעד]
    צעדים = מגדלי_האנוי(נ - 1, עזר, יעד, מקור, צעדים)
    החזר צעדים

צעדים = מגדלי_האנוי(3, "א", "ג", "ב", [])
הדפס("פתרון ל-3 דיסקים (" + מחרוזת(אורך(צעדים)) + " צעדים):")
עבור צעד בתוך צעדים:
    הדפס("  " + צעד)

# ===== חיפוש בינארי =====
הדפס("\n🔍 חיפוש בינארי:")
הדפס("═" * 40)

הגדר חיפוש_בינארי(רשימה, ערך):
    """חיפוש בינארי ברשימה ממוינת"""
    שמאל = 0
    ימין = אורך(רשימה) - 1
    
    כל_עוד שמאל <= ימין:
        אמצע = (שמאל + ימין) // 2
        
        אם רשימה[אמצע] == ערך:
            החזר אמצע
        אחרת_אם רשימה[אמצע] < ערך:
            שמאל = אמצע + 1
        אחרת:
            ימין = אמצע - 1
    
    החזר -1

הגדר חיפוש_בינארי_רקורסיבי(רשימה, ערך, שמאל, ימין):
    """חיפוש בינארי רקורסיבי"""
    אם שמאל > ימין:
        החזר -1
    
    אמצע = (שמאל + ימין) // 2
    
    אם רשימה[אמצע] == ערך:
        החזר אמצע
    אחרת_אם רשימה[אמצע] < ערך:
        החזר חיפוש_בינארי_רקורסיבי(רשימה, ערך, אמצע + 1, ימין)
    אחרת:
        החזר חיפוש_בינארי_רקורסיבי(רשימה, ערך, שמאל, אמצע - 1)

מספרים = [2, 5, 8, 12, 16, 23, 38, 45, 56, 72, 91]
הדפס("רשימה: " + מחרוזת(מספרים))

עבור חיפוש בתוך [23, 45, 100]:
    אינדקס = חיפוש_בינארי(מספרים, חיפוש)
    אם אינדקס >= 0:
        הדפס("נמצא " + מחרוזת(חיפוש) + " באינדקס " + מחרוזת(אינדקס))
    אחרת:
        הדפס(מחרוזת(חיפוש) + " לא נמצא")

# ===== מיון מהיר (Quick Sort) =====
הדפס("\n⚡ מיון מהיר (Quick Sort):")
הדפס("═" * 40)

הגדר מיון_מהיר(רשימה):
    """מיון מהיר רקורסיבי"""
    אם אורך(רשימה) <= 1:
        החזר רשימה
    
    ציר = רשימה[אורך(רשימה) // 2]
    קטנים = []
    שווים = []
    גדולים = []
    
    עבור איבר בתוך רשימה:
        אם איבר < ציר:
            קטנים = קטנים + [איבר]
        אחרת_אם איבר == ציר:
            שווים = שווים + [איבר]
        אחרת:
            גדולים = גדולים + [איבר]
    
    החזר מיון_מהיר(קטנים) + שווים + מיון_מהיר(גדולים)

לא_ממוין = [64, 34, 25, 12, 22, 11, 90, 5]
הדפס("לפני מיון: " + מחרוזת(לא_ממוין))
ממוין = מיון_מהיר(לא_ממוין)
הדפס("אחרי מיון: " + מחרוזת(ממוין))

# ===== מיון מיזוג (Merge Sort) =====
הדפס("\n🔀 מיון מיזוג (Merge Sort):")
הדפס("═" * 40)

הגדר מזג(שמאל, ימין):
    """מיזוג שתי רשימות ממוינות"""
    תוצאה = []
    א = 0
    ב = 0
    
    כל_עוד א < אורך(שמאל) וגם ב < אורך(ימין):
        אם שמאל[א] <= ימין[ב]:
            תוצאה = תוצאה + [שמאל[א]]
            א = א + 1
        אחרת:
            תוצאה = תוצאה + [ימין[ב]]
            ב = ב + 1
    
    # הוסף את השאריות
    כל_עוד א < אורך(שמאל):
        תוצאה = תוצאה + [שמאל[א]]
        א = א + 1
    
    כל_עוד ב < אורך(ימין):
        תוצאה = תוצאה + [ימין[ב]]
        ב = ב + 1
    
    החזר תוצאה

הגדר מיון_מיזוג(רשימה):
    """מיון מיזוג רקורסיבי"""
    אם אורך(רשימה) <= 1:
        החזר רשימה
    
    אמצע = אורך(רשימה) // 2
    שמאל = מיון_מיזוג(רשימה[:אמצע])
    ימין = מיון_מיזוג(רשימה[אמצע:])
    
    החזר מזג(שמאל, ימין)

לא_ממוין2 = [38, 27, 43, 3, 9, 82, 10]
הדפס("לפני מיון: " + מחרוזת(לא_ממוין2))
ממוין2 = מיון_מיזוג(לא_ממוין2)
הדפס("אחרי מיון: " + מחרוזת(ממוין2))

# ===== בעיית המלכות (N-Queens) =====
הדפס("\n👑 בעיית 4 המלכות:")
הדפס("═" * 40)

הגדר בטוח(לוח, שורה, עמודה, נ):
    """בדוק אם בטוח לשים מלכה"""
    # בדוק עמודה
    עבור א בתוך טווח(שורה):
        אם לוח[א] == עמודה:
            החזר שקר
    
    # בדוק אלכסון שמאלי
    עבור א בתוך טווח(שורה):
        אם לוח[א] - א == עמודה - שורה:
            החזר שקר
    
    # בדוק אלכסון ימני
    עבור א בתוך טווח(שורה):
        אם לוח[א] + א == עמודה + שורה:
            החזר שקר
    
    החזר אמת

הגדר פתור_מלכות(לוח, שורה, נ, פתרונות):
    """מצא את כל הפתרונות"""
    אם שורה == נ:
        פתרונות = פתרונות + [לוח[:]]
        החזר פתרונות
    
    עבור עמודה בתוך טווח(נ):
        אם בטוח(לוח, שורה, עמודה, נ):
            לוח[שורה] = עמודה
            פתרונות = פתור_מלכות(לוח, שורה + 1, נ, פתרונות)
            לוח[שורה] = -1
    
    החזר פתרונות

הגדר הדפס_לוח(פתרון):
    """הדפס לוח שחמט"""
    נ = אורך(פתרון)
    עבור שורה בתוך טווח(נ):
        שורת_לוח = ""
        עבור עמודה בתוך טווח(נ):
            אם פתרון[שורה] == עמודה:
                שורת_לוח = שורת_לוח + "👑 "
            אחרת:
                שורת_לוח = שורת_לוח + "⬜ "
        הדפס("  " + שורת_לוח)

לוח = [-1, -1, -1, -1]
פתרונות = פתור_מלכות(לוח, 0, 4, [])
הדפס("נמצאו " + מחרוזת(אורך(פתרונות)) + " פתרונות")
הדפס("\nפתרון ראשון:")
הדפס_לוח(פתרונות[0])

# ===== GCD ו-LCM =====
הדפס("\n🔢 מחלק משותף מקסימלי (GCD):")
הדפס("═" * 40)

הגדר מחלק_משותף(א, ב):
    """אלגוריתם אוקלידס"""
    כל_עוד ב != 0:
        טמפ = ב
        ב = א % ב
        א = טמפ
    החזר א

הגדר כפולה_משותפת(א, ב):
    """כפולה משותפת מינימלית"""
    החזר (א * ב) // מחלק_משותף(א, ב)

הדפס("GCD(48, 18) = " + מחרוזת(מחלק_משותף(48, 18)))
הדפס("GCD(56, 98) = " + מחרוזת(מחלק_משותף(56, 98)))
הדפס("LCM(12, 18) = " + מחרוזת(כפולה_משותפת(12, 18)))

הדפס("\n✨ סיום דוגמת רקורסיה ואלגוריתמים!")
